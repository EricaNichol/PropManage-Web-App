<div>
  <div id="map" style='width: 100%; height: 400px;'></div>
</div>

<br>

  <div class="row">
        <% @listings.each do |listing| %>
    <div class="col-sm-6 col-md-4">
      <div class="thumbnail">
         <%= image_tag listing.image.url(:medium) %>
        <div class="caption">
          <h3><%= listing.description %></h3>
            <p><small><%= listing.address %><br>
                      <%= listing.city %>, <%= listing.country %></small></p>
          <p><%= link_to "VIEW", listing, class: 'btn btn-info btn-sm' %></p>
        </div>
      </div>
    </div>
          <% end %>
  </div>

  <script type="text/javascript">
    debugger
    handler = Gmaps.build('Google');
    handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
      markers = handler.addMarkers(<%= raw listings_json(@listings).to_json %>);
      handler.bounds.extendWith(markers);
      handler.fitMapToBounds();
      handler.getMap().setZoom(11);
    });
  </script>
